var Ye=Object.defineProperty;var Ge=(t,s,a)=>s in t?Ye(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var ee=(t,s,a)=>Ge(t,typeof s!="symbol"?s+"":s,a);import{q as J,u as G,j as e,Q as Qe,a as N,b as ae,c as He,R as Ve}from"./tanstack-BjdLQ5hw.js";import{c as Je,r as i,u as Q,L as se,f as Xe,h as Ke,R as oe,O as be,i as Ze,j as et,k as tt}from"./react-Dm8snE5z.js";import{c as st,i as at}from"./supabase-7q-5WrAP.js";import{d as z,F as g,A as Ie,I as b,B as f,a as p,s as U,T as c,R as nt,b as Te,D as rt,U as te,c as Ce,e as Se,M as de,f as ue,g as ot,h as Pe,i as it,j as me,P as ie,k as lt,l as q,m as ct,n as dt,o as ut,p as Re,q as mt,r as he,t as pt,u as ht,v as ge,w as gt,x as ft,y as xt,z as jt,C as yt,E as kt,G as vt,H as wt,J as bt,K as It,L as Tt,N as Ct,O as St,Q as Pt,S as Rt,V as Ft,W as Fe,X as pe,Y as Et}from"./ant-C-VfHLdv.js";import{R as $t,B as Ot,C as Lt,X as Nt,Y as At,T as _t,a as Ut,L as Dt}from"./recharts-B-HRoCR9.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();var Ee,fe=Je;Ee=fe.createRoot,fe.hydrateRoot;var Mt={items_per_page:"/ стр.",jump_to:"Перейти",jump_to_confirm:"подтвердить",page:"Страница",prev_page:"Назад",next_page:"Вперед",prev_5:"Предыдущие 5",next_5:"Следующие 5",prev_3:"Предыдущие 3",next_3:"Следующие 3",page_size:"размер страницы"},qt={locale:"ru_RU",today:"Сегодня",now:"Сейчас",backToToday:"Текущая дата",ok:"ОК",clear:"Очистить",month:"Месяц",year:"Год",timeSelect:"Выбрать время",dateSelect:"Выбрать дату",monthSelect:"Выбрать месяц",yearSelect:"Выбрать год",decadeSelect:"Выбрать десятилетие",yearFormat:"YYYY",dateFormat:"D-M-YYYY",dayFormat:"D",dateTimeFormat:"D-M-YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Предыдущий месяц (PageUp)",nextMonth:"Следующий месяц (PageDown)",previousYear:"Предыдущий год (Control + left)",nextYear:"Следующий год (Control + right)",previousDecade:"Предыдущее десятилетие",nextDecade:"Следущее десятилетие",previousCentury:"Предыдущий век",nextCentury:"Следующий век"};const $e={placeholder:"Выберите время",rangePlaceholder:["Время начала","Время окончания"]},xe={lang:Object.assign({placeholder:"Выберите дату",yearPlaceholder:"Выберите год",quarterPlaceholder:"Выберите квартал",monthPlaceholder:"Выберите месяц",weekPlaceholder:"Выберите неделю",rangePlaceholder:["Начальная дата","Конечная дата"],rangeYearPlaceholder:["Начальный год","Год окончания"],rangeMonthPlaceholder:["Начальный месяц","Конечный месяц"],rangeWeekPlaceholder:["Начальная неделя","Конечная неделя"],shortWeekDays:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],shortMonths:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"]},qt),timePickerLocale:Object.assign({},$e)},_="${label} не является типом ${type}",Bt={locale:"ru",Pagination:Mt,DatePicker:xe,TimePicker:$e,Calendar:xe,global:{placeholder:"Пожалуйста выберите"},Table:{filterTitle:"Фильтр",filterConfirm:"OK",filterReset:"Сбросить",filterEmptyText:"Без фильтров",filterCheckall:"Выбрать все элементы",filterSearchPlaceholder:"Поиск в фильтрах",emptyText:"Нет данных",selectAll:"Выбрать всё",selectInvert:"Инвертировать выбор",selectNone:"Очистить все данные",selectionAll:"Выбрать все данные",sortTitle:"Сортировка",expand:"Развернуть строку",collapse:"Свернуть строку",triggerDesc:"Нажмите для сортировки по убыванию",triggerAsc:"Нажмите для сортировки по возрастанию",cancelSort:"Нажмите, чтобы отменить сортировку"},Tour:{Next:"Далее",Previous:"Назад",Finish:"Завершить"},Modal:{okText:"OK",cancelText:"Отмена",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Отмена"},Transfer:{titles:["",""],searchPlaceholder:"Поиск",itemUnit:"элем.",itemsUnit:"элем.",remove:"Удалить",selectAll:"Выбрать все данные",selectCurrent:"Выбрать текущую страницу",selectInvert:"Инвертировать выбор",removeAll:"Удалить все данные",removeCurrent:"Удалить текущую страницу"},Upload:{uploading:"Загрузка...",removeFile:"Удалить файл",uploadError:"При загрузке произошла ошибка",previewFile:"Предпросмотр файла",downloadFile:"Загрузить файл"},Empty:{description:"Нет данных"},Icon:{icon:"иконка"},Text:{edit:"Редактировать",copy:"Копировать",copied:"Скопировано",expand:"Раскрыть"},Form:{optional:"(необязательно)",defaultValidateMessages:{default:"Ошибка проверки поля ${label}",required:"Пожалуйста, введите ${label}",enum:"${label} должен быть одним из [${enum}]",whitespace:"${label} не может быть пустым",date:{format:"${label} не правильный формат даты",parse:"${label} не может быть преобразовано в дату",invalid:"${label} не является корректной датой"},types:{string:_,method:_,array:_,object:_,number:_,date:_,boolean:_,integer:_,float:_,regexp:_,email:_,url:_,hex:_},string:{len:"${label} должна быть ${len} символов",min:"${label} должна быть больше или равна ${min} символов",max:"${label} должна быть меньше или равна ${max} символов",range:"Длина ${label} должна быть между ${min}-${max} символами"},number:{len:"${label} должна быть равна ${len}",min:"${label} должна быть больше или равна ${min}",max:"${label} должна быть меньше или равна ${max}",range:"${label} должна быть между ${min}-${max}"},array:{len:"Количество элементов ${label} должно быть равно ${len}",min:"Количество элементов ${label} должно быть больше или равно ${min}",max:"Количество элементов ${label} должно быть меньше или равно ${max}",range:"Количество элементов ${label} должно быть между ${min} и ${max}"},pattern:{mismatch:"${label} не соответствует шаблону ${pattern}"}}},Image:{preview:"Предпросмотр"},QRCode:{expired:"QR-код устарел",refresh:"Обновить"}},M={user:"user",userAvatar:"userAvatar",checkLogin:"checkLogin",attachments:"attachments",attachmentsUrl:"attachmentsUrl",tasks:"tasks",completedTasks:"completedTasks",taskTypes:"taskTypes"};class S{constructor(s){ee(this,"name");ee(this,"message");ee(this,"code");this.message=s.message,this.name=s.name,s.code&&(this.code=s.code)}}const v=st("https://bezykkplqcrsoettxmqn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJlenlra3BscWNyc29ldHR4bXFuIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MTAzMzUxMTUsImV4cCI6MjAyNTkxMTExNX0.vxAZ78i4fJs8x3WYn9W_vxxTMz8DiQuJngbP_upuz40"),Z=t=>{if(t instanceof Error)throw new S(t);if(t!=null&&t.code)throw console.log("DataProvider?.checkApiError",t),t},zt=t=>J({queryKey:[M.checkLogin,t],queryFn:async({queryKey:s,signal:a})=>{console.log("signal",a);const{data:r,error:n}=await v.from("users").select().eq("login",s[1]).abortSignal(a);if(n)throw new S({message:n.message,name:"Не удалось проверить логин"});return!!r.length}}),Wt=async t=>{const{data:s,error:a}=await v.from("users").update(t).eq("id",t.id).select();if(a)throw new S({message:a.message,name:"Не удалось обновить данные пользователя"});if(s)return s[0]},Yt=t=>J({queryKey:[M.user,t],queryFn:async({queryKey:s,signal:a})=>{const{data:r,error:n}=await v.from("users").select().eq("id",s[1]).abortSignal(a);if(n)throw new S({message:n.message,name:"Не удалось получить данные пользователя"});return r[0]},enabled:!!t}),le={checkLogin:zt,updateUserInfo:Wt,getUserById:Yt},Gt=t=>J({queryKey:[M.attachments,t],queryFn:async({signal:s,queryKey:a})=>{const{data:r,error:n}=await v.from("attachments").select().eq("id",a[1]).abortSignal(s);if(n)throw new S({name:"Не удалось получить вложения",message:`${n.code}: ${n.message}`});return r[0]},select:s=>({fullPath:s.full_path,id:s.id,path:s.path,publicUrl:s.public_url}),enabled:!!t}),Qt=async(t,s)=>{const{error:a}=await v.from("attachments").delete().eq("id",t.id);if(a)throw new S({name:"Не удалось удалить вложения",message:`${a.code}: ${a.message}`});const{error:r}=await v.storage.from(s).remove([t.path]);if(r)throw new S({name:"Не удалось удалить файл из хранилища",message:`${r.name}: ${r.message}`})},Ht=async(t,s)=>{const{data:a,error:r}=await v.storage.from(s).upload(t.name,t);if(r)throw new S({name:"Не удалось сохранить вложения",message:`${r.name}: ${r.message}`});const{data:{publicUrl:n}}=v.storage.from(s).getPublicUrl(a.path);console.log("uploadedFile",a);const{error:o}=await v.from("attachments").insert([{id:a.id,path:a.path,full_path:a.fullPath,public_url:n||null}]).select();if(o)throw new S({name:"Не удалось получить вложения",message:`${o.code}: ${o.message}`});return{...a,publicUrl:n}},ce={getAttachmentById:Gt,deleteAttachment:Qt,saveAttachment:Ht},je="sb-bezykkplqcrsoettxmqn-auth-token",Oe=i.createContext({user:null,isAuthCheking:!0,isUserLoading:!1,setUserId:()=>{},logOut:()=>{}}),Vt=({children:t})=>{const[s,a]=i.useState(null),[r,n]=i.useState(!0),{data:o=null,isFetching:l}=G({...le.getUserById(s),refetchOnWindowFocus:!1}),{data:u=null}=G({...ce.getAttachmentById(o==null?void 0:o.avatar_id)}),x=()=>{localStorage.removeItem(je),a(null)};i.useEffect(()=>{const T=localStorage.getItem(je);if(!T){n(!1);return}const{user:w}=JSON.parse(T);w.id&&(a(w.id),n(!1))},[]),i.useEffect(()=>{o&&!r&&n(!1)},[o,r]);const I=i.useMemo(()=>o?{...o,avatar:u||null}:null,[o,u]);return e.jsx(Oe.Provider,{value:{user:I,isAuthCheking:r,setUserId:a,isUserLoading:l,logOut:x},children:t})},Jt=new Qe,Xt={cssVar:!0,token:{fontFamily:"Roboto, sans-serif",fontSize:18,colorBgLayout:"none",colorLink:"#7CB2B0",colorBorder:"#D2D7E3",colorTextPlaceholder:"var(--gray-5)"},components:{Layout:{siderBg:"#CDE1E1"},Input:{colorBgBase:"none",colorBgContainer:"none",fontSize:16,borderRadius:0},Typography:{titleMarginBottom:"none",titleMarginTop:"none"},Upload:{colorInfoText:"var(--gray-5)"}}},E={REQUIRED:"Поле обязательно",PASSWORD_DUPLICATE:"Пароли должны совпадать",MIN_LENGTH:t=>`Минимальная длина ${t} символов`,MAX_LENGTH:t=>`Максимальная длина ${t} символов`,CYRILLIC:"Недопустимые символы,только кирилица"},Kt=14,Zt=z().subtract(Kt,"year"),es=z(),ye=5,ke=25,ts="Логин уже занят",F={SIGN_IN:"/sign-in",SIGN_UP:"/sign-up",RESET_PASSWORD:"/reset-password",UPDATE_PASSWORD:"/update-password",BASE:"/",USER:"/user",CHECK_LOGIN:"/check-login",STATISTIC:"/statistic",TASKS:"/tasks",LOGOUT:"/logout",INFO:"/info"},ss="http://localhost:5173/update-password",as=async({email:t,password:s})=>{const{data:a,error:r}=await v.auth.signInWithPassword({email:t,password:s});return Z(r),a},ns=async({email:t,password:s})=>{const{data:a,error:r}=await v.auth.signUp({email:t,password:s});if(at(r))throw new S({name:"Недопустимый пароль",message:r.message});Z(r);const{data:n,error:o}=await v.from("users").upsert({id:a.user.id,login:a.user.email,email:a.user.email});return Z(o),n},rs=async t=>{const{data:s,error:a}=await v.auth.resetPasswordForEmail(t,{redirectTo:ss});return Z(a),s},os=async t=>{const{data:s,error:a}=await v.auth.updateUser({password:t});return Z(a),s},ne={signIn:as,signUp:ns,resetPassword:rs,updatePassword:os},B=()=>i.useContext(Oe),ve=()=>{const{setUserId:t}=B(),s=Q(),a=N({mutationFn:ne.signIn,onSuccess:n=>{t(n.user.id),s(F.BASE)}}),r=n=>{a.mutate({email:n.email,password:n.password})};return e.jsxs(e.Fragment,{children:[e.jsxs(g,{name:"sign-in",layout:"vertical",style:{width:"100%"},onFinish:r,children:[!!a.error&&e.jsx(Ie,{message:a.error.message||"",type:"error"}),e.jsx(g.Item,{name:"email",label:"Почта пользователя",rules:[{required:!0,message:E.REQUIRED}],children:e.jsx(b,{size:"large",type:"email"})}),e.jsx(g.Item,{name:"password",label:"Пароль",rules:[{required:!0,message:E.REQUIRED}],children:e.jsx(b.Password,{size:"large",type:"password"})}),e.jsx(g.Item,{style:{textAlign:"center"},children:e.jsx(f,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:a.isPending,children:"Войти"})})]}),e.jsxs(p,{className:"sign-in-actions",align:"center",justify:"space-between",children:[e.jsx(se,{to:F.RESET_PASSWORD,children:"Забыли пароль ?"}),e.jsx(se,{to:F.SIGN_UP,children:"Регистрация"})]})]})},is=()=>{const t=Q(),s=Xe(),a=N({mutationFn:ne.signUp,onSuccess:()=>{U.success("Вы успешно зарегестрированы войдите в систему"),t(F.BASE)}});return e.jsxs(g,{layout:"vertical",style:{width:"100%"},onFinish:a.mutate,disabled:a.isPending,children:[!!a.error&&e.jsx(Ie,{style:{margin:"10px 0"},message:s.message||"",type:"error"}),e.jsx(g.Item,{name:"email",label:"Почта",rules:[{required:!0,message:E.REQUIRED}],children:e.jsx(b,{size:"large",type:"email"})}),e.jsx(g.Item,{name:"password",label:"Пароль",rules:[{required:!0,message:E.REQUIRED}],children:e.jsx(b.Password,{size:"large",type:"password"})}),e.jsx(g.Item,{name:"passwordRepeat",dependencies:["password"],label:"Повторите пароль",rules:[{required:!0,message:E.REQUIRED},({getFieldValue:r})=>({validator(n,o){return!o||r("password")===o?Promise.resolve():Promise.reject(new Error(E.PASSWORD_DUPLICATE))}})],children:e.jsx(b.Password,{size:"large",type:"password"})}),e.jsx(g.Item,{style:{textAlign:"center"},children:e.jsx(f,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:a.isPending,children:"Зарегестрироваться"})}),e.jsx(p,{align:"center",justify:"center",children:e.jsx(se,{to:F.SIGN_IN,children:"К форме аторизации"})})]})},ls=()=>{const t=N({mutationFn:ne.resetPassword,onSuccess:()=>{U.success("Письмо отправлено на почту")}});return console.log("resetPasswordMutation.data",t.data),e.jsxs(e.Fragment,{children:[t.data?e.jsx(c.Title,{level:2,style:{textAlign:"center",marginBottom:"1rem"},children:"Письмо отправлено на email"}):e.jsxs(g,{name:"sign-in",layout:"vertical",style:{width:"100%"},onFinish:({email:s})=>t.mutate(s),children:[e.jsx(g.Item,{name:"email",label:"Почта пользователя",rules:[{required:!0,message:E.REQUIRED}],children:e.jsx(b,{size:"large",type:"email"})}),e.jsx(g.Item,{style:{textAlign:"center"},children:e.jsx(f,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:t.isPending,children:"Сбросить пароль"})})]}),e.jsx(p,{align:"center",justify:"center",children:e.jsx(se,{to:F.SIGN_IN,children:"К форме аторизации"})})]})},cs=(t,s)=>{const a=new FileReader;a.addEventListener("load",()=>s(a.result)),a.readAsDataURL(t)},Le=t=>{const s=t.type==="image/jpeg"||t.type==="image/png";if(!s)return"Загрузить можно только файлы в формате: jpeg, png";const a=t.size/1024/1024<2;return a?s&&a:"Файл должен быть меньше 2MB"},ds="DD.MM.YYYY",us=1e3,Ne=60*us,Ae=(t,s)=>{if(t===s)return!0;if(typeof t!="object"&&typeof t!="function"||typeof s!="object"&&typeof s!="function")return!1;if(t===null||s===null)return t===s;const a=Object.keys(t),r=Object.keys(s);if(a.length!==r.length)return!1;for(let n of a)if(!r.includes(n)||!Ae(t[n],s[n]))return!1;return!0},ms=()=>{const{user:t}=B(),s=ae(),[a,r]=i.useState(!1),[n,o]=i.useState(null),[l,u]=i.useState(!1),[x]=g.useForm(),I=i.useRef(ps),T=N({mutationFn:y=>le.updateUserInfo({...y,id:t.id}),onSuccess:(y,P)=>{s.setQueryData([M.user,t==null?void 0:t.id],{...t,...P})}}),w=N({mutationFn:async y=>ce.deleteAttachment(y,"avatar")}),k=N({mutationFn:async y=>ce.saveAttachment(y,"avatar")});i.useEffect(()=>{var y;I.current={login:(t==null?void 0:t.login)||"",birthday:z(t==null?void 0:t.birthdate),surname:(t==null?void 0:t.surname)||"",name:(t==null?void 0:t.name)||"",patronymic:(t==null?void 0:t.patronymic)||"",avatar:(t==null?void 0:t.avatar)||null},(y=t==null?void 0:t.avatar)!=null&&y.publicUrl&&o(t.avatar.publicUrl),x.setFieldsValue(I.current)},[t,x]);const A=async(y,P)=>{if(P===(t==null?void 0:t.login))return Promise.resolve();try{return await s.fetchQuery(le.checkLogin(P))?Promise.reject(ts):Promise.resolve()}catch{return Promise.reject("При проверке логина произошла ошибка")}},$=y=>{u(!Ae(y,I.current))},j=({file:y})=>{y&&(r(!0),x.setFieldValue("avatar",y),cs(y,P=>{r(!1),o(P)}))},d=()=>{x.setFieldValue("avatar",""),o(null),u(!0)},m=x.getFieldsError().filter(({errors:y})=>y.length).length>0,h=async()=>{const y=t==null?void 0:t.avatar,P=x.getFieldValue("avatar");return y&&(P instanceof File||!P)&&await w.mutateAsync(y),P instanceof File?await k.mutateAsync(P):null};return{isAvatarLoading:a,checkDirty:$,avatarUrl:n,isFormDirty:l,form:x,updateUser:async y=>{const{avatar:P,...W}=y;let Y;return P!==(t==null?void 0:t.avatar)?Y=await h():Y=(t==null?void 0:t.avatar)||null,T.mutate({...W,avatar_id:(Y==null?void 0:Y.id)||null})},handleChangeAvatar:j,deleteAvatar:d,checkLogin:A,updateAvatar:h,hasErrors:m,isFormSubmitting:T.isPending||k.isPending||w.isPending}},ps={login:"",birthday:null,surname:"",name:"",patronymic:"",avatar:null},{confirm:hs}=de,gs=({onCancel:t})=>{const{form:s,updateUser:a,checkDirty:r,isAvatarLoading:n,avatarUrl:o,isFormDirty:l,handleChangeAvatar:u,deleteAvatar:x,checkLogin:I,isFormSubmitting:T}=ms(),w=j=>{a(j).then(()=>{U.success("Данные успешно сохранены"),t()}).catch(()=>{U.error("Ошибка при сохранении данных")})},k=e.jsx(f,{style:{border:0,background:"none"},type:"text",children:e.jsx(p,{vertical:!0,align:"center",justify:"center",children:n?e.jsx(nt,{}):e.jsxs(c.Paragraph,{type:"secondary",style:{marginTop:8},children:[e.jsx(Te,{style:{color:"var(--gray-7)"}})," Загрузить"]})})}),A=()=>{l?hs({title:"Закрыть окно ?",content:"Несохраненные изменения будут утеряны.",okText:"Да",cancelText:"Нет",onOk:t}):t()},$=j=>{const d=Le(j),m=typeof d!="string";return m||U.error(d),m};return e.jsxs(g,{onFinish:w,labelAlign:"left",layout:"vertical",labelWrap:!0,disabled:T,form:s,onValuesChange:(j,d)=>r(d),size:"large",style:{position:"relative",maxWidth:"600px"},children:[e.jsxs("div",{className:"base-fields-container",children:[e.jsxs(p,{vertical:!0,flex:1,children:[e.jsx(g.Item,{label:"Логин",name:"login",wrapperCol:{span:22},validateTrigger:["onBlur","onChange"],validateFirst:!0,rules:[{required:!0,message:E.REQUIRED},{min:ye,message:E.MIN_LENGTH(ye)},{max:ke,message:E.MAX_LENGTH(ke)},{validateTrigger:["onBlur"],validator:I}],children:e.jsx(b,{placeholder:"LUKA"})}),e.jsx(g.Item,{label:"Дата рождения",name:"birthday",wrapperCol:{span:22},rules:[{required:!0,message:E.REQUIRED,type:"date"}],children:e.jsx(rt,{style:{width:"100%"},placeholder:"06.06.0006",format:ds,maxDate:es,minDate:Zt})})]}),e.jsxs(g.Item,{name:"avatar",valuePropName:"fileList[0]",style:{position:"relative"},children:[e.jsx(te,{className:"person-form-upload",name:"avatar",listType:"picture-card",showUploadList:!1,beforeUpload:$,customRequest:u,disabled:!!o,children:o?e.jsx("div",{style:{margin:"4px",borderRadius:"4px",overflow:"hidden"},children:e.jsx(Ce,{height:140,style:{objectFit:"cover"},src:o,preview:{toolbarRender:()=>null}})}):k}),o&&e.jsx(f,{style:{position:"absolute",bottom:-32,right:0},type:"text",size:"small",onClick:x,icon:e.jsx(Se,{})})]})]}),e.jsx(g.Item,{label:"Фамилия",name:"surname",rules:[{pattern:/^[\s\u0400-\u04FF]+$/,message:E.CYRILLIC}],children:e.jsx(b,{placeholder:"Лукавый"})}),e.jsx(g.Item,{label:"Имя",name:"name",rules:[{pattern:/^[\s\u0400-\u04FF]+$/,message:E.CYRILLIC}],children:e.jsx(b,{placeholder:"Лука"})}),e.jsx(g.Item,{label:"Отчество",name:"patronymic",rules:[{pattern:/^[\s\u0400-\u04FF]+$/,message:E.CYRILLIC}],children:e.jsx(b,{placeholder:"Лукич"})}),e.jsxs(p,{gap:16,justify:"end",children:[e.jsx(f,{type:"primary",htmlType:"submit",disabled:!l,children:"Сохранить"}),e.jsx(f,{type:"default",onClick:A,children:"Отмена"})]})]})};function fs({hideContainer:t}){var o;const[s,a]=i.useState(!1),{user:r}=B(),n=()=>{t(),a(!0)};return e.jsxs(ue.Ribbon,{text:e.jsx(c,{children:"Новичок"}),children:[e.jsxs(p,{vertical:!0,gap:16,className:"acc-container",children:[e.jsxs(p,{gap:16,children:[e.jsx(ot,{shape:"square",size:64,gap:8,src:(o=r==null?void 0:r.avatar)==null?void 0:o.publicUrl,icon:e.jsx(Pe,{})}),e.jsxs(p,{vertical:!0,gap:16,children:[e.jsx(c,{children:r==null?void 0:r.login}),e.jsx(c,{children:r==null?void 0:r.email}),e.jsx(c,{children:[r==null?void 0:r.surname,r==null?void 0:r.name].filter(Boolean).join(" ")})]})]}),e.jsx(f,{className:"acc-edit-button",icon:e.jsx(it,{}),size:"large",type:"text",onClick:n})]}),e.jsx(de,{open:s,closable:!1,footer:null,centered:!0,destroyOnClose:!0,title:"Реадктирование данных профиля",children:e.jsx(gs,{onCancel:()=>{a(!1)}})})]})}const{Text:xs}=c,js=()=>{const t=Q(),a=Ke().reduce((r,n,o)=>{var l,u;return(l=n.handle)!=null&&l.title&&r.push(e.jsx(xs,{strong:!0,children:(u=n.handle)==null?void 0:u.title},o)),r},[]);return a.length?e.jsxs(p,{gap:8,align:"center",style:{borderBottom:"1px solid var(--gray-5)",minHeight:"fit-content"},children:[e.jsx(f,{type:"text",icon:e.jsx(me,{}),onClick:()=>{t(F.BASE)}}),a]}):null},ys=()=>{const{logOut:t}=B(),[s,a]=i.useState(!1);return e.jsxs(p,{justify:"space-between",className:"menu-wrapper",align:"center",children:[e.jsxs(p,{children:[e.jsxs("div",{className:"user-button-wrapper",children:[e.jsx(f,{type:"text",icon:e.jsx(Pe,{size:24}),onClick:()=>a(!0)}),e.jsx(ie,{placement:"bottomLeft",content:e.jsx(fs,{hideContainer:()=>a(!1)}),overlayInnerStyle:{padding:0},arrow:!1,open:s,trigger:"click",onOpenChange:r=>a(r),children:e.jsx("div",{className:"menu-point-popover"})})]}),e.jsx(js,{})]}),e.jsx(p,{children:e.jsx(f,{type:"text",icon:e.jsx(lt,{size:24}),title:"Выход",onClick:t})})]})},ks={name:"",email:"",messubject:"",description:""},vs=({close:t,isOpen:s,isPlugActive:a=!1})=>{const[r]=g.useForm(),[n,o]=oe.useState([]),[l,u]=oe.useState(""),[x,I]=oe.useState(!1),T=N({mutationFn:ws,onSuccess:()=>{U.success("Обращение успешно отправлено"),r.resetFields(),o([]),t()},onError:()=>{U.error("Не удалось отправить обращение")}}),w=d=>{const m=Le(d);return console.log("result",m),typeof m=="string"?(U.error(m+":"+d.name),te.LIST_IGNORE):!0},k=({file:d})=>{console.log("handleUploadChange",n),o([...n,d])},A=async d=>{console.log("handlePreview",d),!d.url&&!d.preview&&d.originFileObj&&(d.preview=URL.createObjectURL(d.originFileObj)),u(d.url||d.preview||URL.createObjectURL(d)),I(!0)},$=d=>{const m={...d,attachments:n.map(h=>h.originFileObj).filter(Boolean)};T.mutate(m)},j=()=>{u(""),o([]),t()};return e.jsx(de,{title:e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:4,children:"Форма обратной связи "}),a&&e.jsx(c.Text,{children:"(функицонал в разрботке) "})]}),open:s,onCancel:j,destroyOnClose:!0,footer:null,className:q("feed-back-modal",a&&"feed-back-modal--plug"),children:a?e.jsx(e.Fragment,{children:e.jsxs(c.Paragraph,{children:["Можете направить предложения или замечания по работе на этот адрес: ",e.jsx("br",{}),e.jsx(c.Link,{href:"mailto:gladkoff.0-0@yandex.ru?subject=Предложение к улучшению по ССД&body=Добрый день! Далее Ваш текст...'",children:"gladkoff.0-0@yandex.ru"})]})}):e.jsxs(g,{name:"feedback_form",layout:"vertical",onFinish:$,form:r,initialValues:ks,size:"large",children:[e.jsxs(p,{justify:"space-between",gap:16,children:[e.jsxs(p,{vertical:!0,flex:1,children:[e.jsx(g.Item,{label:"Имя",name:"name",rules:[{required:!0}],children:e.jsx(b,{})}),e.jsx(g.Item,{label:"Email",name:"email",validateTrigger:["onBlur"],rules:[{required:!0,message:""},{required:!0,type:"email",message:"Введен некоретный email"}],children:e.jsx(b,{})}),e.jsx(g.Item,{label:"Тема",name:"subject",rules:[{required:!0,message:"Введите тему"},{min:6,message:"Тема должна быть не менее 6 символов"}],children:e.jsx(b,{})})]}),e.jsx(p,{flex:1,children:e.jsx(g.Item,{style:{width:"100%"},label:"Описание",name:"description",rules:[{required:!0,message:"Введите описание"},{min:10,message:"Описание должно быть не менее 10 символов"}],children:e.jsx("div",{style:{position:"relative"},children:e.jsx(b.TextArea,{rows:7,style:{resize:"none",paddingBottom:40}})})})})]}),n.length>0&&e.jsx(te,{fileList:n,className:"feedback-attachments",onRemove:d=>{const m=n.indexOf(d),h=n.slice();h.splice(m,1),o(h)},onPreview:A,listType:"text"}),l&&e.jsx(Ce,{style:{display:"none",height:0},src:l,preview:{visible:x,onVisibleChange:d=>I(d),destroyOnClose:!0,toolbarRender:()=>null}}),e.jsxs(p,{children:[e.jsx(te,{beforeUpload:w,fileList:n,multiple:!0,maxCount:5,accept:".jpeg,.jpg,.png",showUploadList:!1,customRequest:k,children:e.jsx(f,{icon:e.jsx(Te,{}),type:"text"})}),e.jsxs(p,{style:{marginLeft:"auto"},gap:8,children:[e.jsx(f,{onClick:j,children:"Отмена"}),e.jsx(f,{type:"primary",htmlType:"submit",loading:T.isPending,children:"Отправить"})]})]})]})})},ws=async t=>(console.log("sendFeedback",t),await new Promise(s=>setTimeout(s,1e3)),Math.random()>.3?Promise.resolve():Promise.reject(new Error("Ошибка сервера"))),bs=()=>{const[t,s]=i.useState(!1),a=Q();return e.jsxs(p,{justify:"space-between",className:"footer-wrapper",align:"center",children:[e.jsxs(p,{gap:"0.5rem",children:[e.jsx(f,{type:"text",icon:e.jsx(ct,{size:24}),title:"Статистика",onClick:()=>{a(F.STATISTIC)}}),e.jsx(f,{icon:e.jsx(dt,{size:24}),onClick:()=>a(F.INFO),type:"text",title:"О приложении"}),e.jsx(f,{icon:e.jsx(ut,{size:24}),onClick:()=>s(!0),type:"text"})]}),e.jsx(c.Link,{style:{paddingRight:"0.4rem"},children:" gladk0ff"}),e.jsx(vs,{close:()=>s(!1),isOpen:t,isPlugActive:!0})]})},Is=()=>e.jsxs("div",{className:"main-layout",children:[e.jsx(ys,{}),e.jsx(be,{}),e.jsx(bs,{})]});var C=(t=>(t.active="active",t.complete="complete",t.new="new",t))(C||{});const Ts=()=>J({queryKey:[M.taskTypes],queryFn:async({signal:t})=>{const{data:s,error:a}=await v.from("task_types").select("*").abortSignal(t);if(a)throw new S({name:"Не удалось получить типы задач",message:`${a.code}: ${a.message}`});return s}}),Cs=t=>J({queryKey:[M.tasks,t],queryFn:async({signal:s,queryKey:a})=>{const{data:r,error:n}=await v.from("tasks").select("*").eq("author_id",a[1]).abortSignal(s);if(n)throw new S({name:"Не удалось список задач",message:`${n.code}: ${n.message}`});return r}}),Ss=(t,s)=>J({queryKey:[M.completedTasks,t,s],queryFn:async({signal:a,queryKey:r})=>{const n=v.from("tasks").select("*").eq("author_id",r[1]).eq("status_id",C.complete).order("created_at",{ascending:!1});s&&n.eq("type_id",s);const{data:o,error:l}=await n.abortSignal(a);if(l)throw new S({name:"Не удалось список задач",message:`${l.code}: ${l.message}`});return o}}),Ps=async({authorId:t,task:s,taskStatus:a,typeId:r})=>{const{data:n,error:o}=await v.from("tasks").insert({author_id:t,type_id:r,text:s,status_id:a}).select();if(o)throw new S({name:"Не удалось создать задачу",message:`${o.code}: ${o.message}`});return n[0]},Rs=async t=>{const{data:s,error:a}=await v.from("tasks").insert(t).select();if(a)throw new S({name:"Не удалось создать задачи",message:`${a.code}: ${a.message}`});return s},Fs=async t=>{const{error:s}=await v.from("tasks").delete().eq("id",t);if(s)throw new S({name:"Не удалось удалить задачу",message:`${s.code}: ${s.message}`});return t},Es=async({id:t,...s})=>{const{data:a,error:r}=await v.from("tasks").update({...s,updated_at:z().toISOString()}).eq("id",t).select();if(r)throw new S({name:"Не удалось обновить задачу",message:`${r.code}: ${r.message}`});return a[0]},$s=async t=>{const{error:s,data:a}=await v.from("tasks").update({status_id:C.complete,completed_at:z().toISOString()}).eq("author_id",t).eq("done",!0).eq("status_id",C.active).lt("created_at",z().startOf("day").format("YYYY-MM-DD")).select();if(s)throw new S({name:"Не удалость изменить статус задач на завершенные",message:`${s.code}: ${s.message}`});return a},Os=async t=>{const{error:s}=await v.from("tasks").update({important:!0}).eq("author_id",t).eq("status_id",C.active).or("done.is.null,done.eq.false").lt("created_at",z().startOf("day").format("YYYY-MM-DD"));if(s)throw new S({name:"Не удалость изменить статус задач на завершенные",message:`${s.code}: ${s.message}`})},D={getTaskTypes:Ts,getUserTasks:Cs,getUserCompletedTasks:Ss,createTask:Ps,createTasks:Rs,deleteTask:Fs,updateTask:Es,setTasksToComplete:$s,updateActiveTaskDate:Os};var L=(t=>(t.soul="soul",t.health="health",t.social="social",t.life="life",t.growth="growth",t.mind="mind",t.rest="rest",t))(L||{});const Ls=()=>{const{user:t}=B(),[s,a]=i.useState(!1),[r,n]=i.useState(),o=i.useMemo(()=>(t==null?void 0:t.id)||"",[t==null?void 0:t.id]),{mutate:l,isPending:u}=N({mutationFn:m=>D.setTasksToComplete(m),onSuccess:async m=>{const h=m.filter(O=>O.repeatable);h.length?d(h):a(!0)}}),{mutate:x,isPending:I}=N({mutationFn:m=>D.updateActiveTaskDate(m)}),{mutate:T,isPending:w}=N({mutationFn:m=>D.createTasks(m),onSettled:async()=>{a(!0)}}),{data:k,isLoading:A}=G({...D.getTaskTypes(),refetchOnWindowFocus:!1,refetchOnMount:!1}),{data:$=[],isLoading:j}=G({...D.getUserTasks(o),refetchIntervalInBackground:!0,refetchInterval:5*Ne,refetchOnWindowFocus:!1,enabled:s&&!u&&!I&&!w}),d=m=>{const h=m.map(({author_id:O,type_id:y,text:P,repeatable:W})=>({author_id:O,type_id:y,text:P,repeatable:W,done:!1,status_id:C.new}));T(h)};return i.useEffect(()=>{o&&!s&&(l(o),x(o))},[o,s,l,x]),i.useEffect(()=>{if(!(k!=null&&k.length))return;const m={};k.forEach(h=>{m[h.id]||(m[h.id]={data:[],stats:{inWork:0,done:0},label:h.title})}),$.forEach(h=>{m[h.type_id].data.push(h),h.status_id===C.active&&(m[h.type_id].stats.inWork+=1,h.done&&(m[h.type_id].stats.done+=1))}),n(m)},[$,k]),{taskTypesIsLoading:A,taskTypes:k,userTasks:$,userTasksIsLoading:j,taskGroups:r,userId:o}};function Ns(t,s){const[a,r]=i.useState(t);return i.useEffect(()=>{const n=setTimeout(()=>{r(t)},s);return()=>{clearTimeout(n)}},[t,s]),a}const As=({task:t,isChangeStateBlock:s})=>{const{done:a,priority:r=0}=t,[n,o]=i.useState(t.text),l=i.useRef(!1),u=i.useRef(null),x=Ns(n,700),I=ae(),{user:T}=B(),w=N({mutationFn:D.deleteTask,onSuccess:R=>{I.setQueryData([M.tasks,T.id],X=>X==null?void 0:X.filter(H=>H.id!==R))}}),{mutate:k,isPending:A}=N({mutationFn:D.updateTask,onSuccess:R=>{I.setQueryData([M.tasks,T.id],X=>{const H=[...X??[]],re=H.findIndex(We=>We.id===R.id);return re!==-1&&(H[re]={...H[re],...R}),[...H]})}}),$=()=>{w.mutate(t.id,{onError:R=>{U.error(R.message)}})},j=i.useCallback(R=>{console.log("updateTask",R),k(R)},[k]),d=R=>{R.stopPropagation(),l.current=!1,j({...t,done:!t.done})},m=()=>{j({...t,important:!t.important})},h=()=>{j({...t,status_id:t.status_id===C.active?C.new:C.active,done:!1})},O=()=>{j({...t,repeatable:!t.repeatable})},y=()=>{j({...t,status_id:C.complete,done:!0})},P=w.isPending||A,W=t.important?mt:he;i.useEffect(()=>{var R;l.current&&((R=u.current)==null||R.focus()),t.text!==x&&j({...t,text:x})},[x,t,j]);const Y=()=>{switch(t.status_id){case C.active:return e.jsx(b,{ref:u,className:q("task-input",!!r&&`task-input--prioriry-${r}`,{"task-input--done":!!a,"task-input--has-prioriry ":!!r,"task-input--important ":!!t.important}),onFocus:()=>{l.current=!0},onBlur:()=>{l.current=!1},value:n,disabled:P,onChange:R=>{o(R.target.value)},prefix:e.jsx(f,{icon:e.jsx(gt,{className:q("task-icon-check-online",a&&"task-icon-check-online--checked")}),type:"text",onClick:d}),suffix:e.jsx(ie,{trigger:"click",placement:"left",content:e.jsxs(p,{gap:8,children:[e.jsx(f,{className:t.important?"task-action--active":"",icon:e.jsx(he,{}),type:"text",onClick:m}),e.jsx(f,{disabled:!t.done,icon:e.jsx(ft,{}),title:"Сделано вчера",type:"text",onClick:y}),e.jsx(f,{className:t.repeatable?"task-action--active":"",icon:e.jsx(Re,{}),onClick:O,type:"text"}),e.jsx(f,{icon:e.jsx(xt,{}),onClick:h,type:"text"}),e.jsx(f,{disabled:w.isPending,className:"action-delete",icon:e.jsx(Se,{}),onClick:$,type:"text"})]}),children:e.jsx(ge,{})})});case C.new:return e.jsx(b,{className:q("task-input",{"task-input--important ":!!t.important}),value:n,disabled:P,onChange:R=>{o(R.target.value)},prefix:e.jsx(f,{icon:e.jsx(pt,{}),disabled:s,onClick:h,type:"text"}),suffix:e.jsx(ie,{trigger:"click",placement:"left",content:e.jsxs(p,{gap:8,children:[e.jsx(f,{icon:e.jsx(W,{}),type:"text",onClick:m}),e.jsx(f,{className:"action-delete",icon:e.jsx(ht,{}),onClick:$,type:"text"})]}),children:e.jsx(ge,{})})})}};return e.jsx(p,{justify:"space-between",align:"center",gap:16,children:Y()})},_s=({text:t,author_id:s,type_id:a,created_at:r})=>{const n=ae(),o=N({mutationFn:D.createTask}),l=()=>{o.mutate({authorId:s,task:t,taskStatus:C.new,typeId:a},{onSuccess:async()=>{await n.invalidateQueries({queryKey:[M.tasks,s]}),U.success("Задача добавлена в 'Запланированные' ")}})};return e.jsx(p,{justify:"space-between",align:"center",gap:16,className:"task-completed-row",children:e.jsx(b,{className:"task-input",value:t,readOnly:!0,prefix:z(r).format("DD.MM"),suffix:e.jsx(f,{onClick:l,icon:e.jsx(Re,{}),shape:"circle",type:"text",loading:o.isPending})})})},Us=()=>e.jsxs(c.Paragraph,{children:["Привет! ",e.jsx("br",{}),"Данное приложение создано, как плод работы моих мыслей по поводу нашего бренного прибывания! ",e.jsx("br",{}),"- Кто я? Чего делаю и зачем ? В чем смысл?",e.jsx("br",{}),"- Насколько я близок с Богом?",e.jsx("br",{}),"- Что нужно делать? Как правильно двигаться? ",e.jsx("br",{}),"- Что я хочу и куда стремлюсь? ",e.jsx("br",{}),"- Что я делаю для развития? Доволен ли я результатом своих действий ?",e.jsx("br",{}),"- Что является движущий силой для меня?",e.jsx("br",{}),e.jsx("br",{}),"Если мысли эти Тебе чужды то возможно это приложение, которое создано впервую очередь как помошник мне в собственной жизни - не подойдет Тебе, в этом нет ничего страшного - значит у Тебя свой путь - ищи его ! и Удачи Тебе! Если в чем-то вопросы совпадают или Ты понимаешь ход моих мыслей, то читай далее... Аксимома - Принял тот факт, что ответом на все вопросы у меня нет, сей час точно, а может и не будет никогда...",e.jsx("br",{}),"Факт 1 - жизнь идет несмотря на то , нашел ли я ответы или нет и с этим надо что-то делать",e.jsx("br",{}),"Факт 2 - мне почему-то ничего не хочется, может потому что очень долго был зависимым или в базовой комплектации со мной что-то не так - суть имеем что имеем",e.jsx("br",{}),"Вывод - выделить оснонвые группы дел (как мне кажется) в течении жизни, которые спосоствуют гармоничному развитию личности (опять же по-моему мнению) чтобы двигаться по ним пока идет поиск ответов на вопросы, что ранее перечислил...",e.jsx("br",{}),"Итог: Созданы 7+1 направление (+1 потому то одну категорию - из опыта, надо включить позже, когда освоишься с системой и она войдет в Твою жизнь) которые надо сделать привычками(привычками потому что Факт2 - ничего не хочется=) ), это разовьет дисциплину, в дисциплина это всего хорошо. это всегда Сила Воли",e.jsx("br",{}),"Категории, что я выделил: Здоровье, Духовное-нравственное развитие, Взаимодействие с социумом, Развитие интеллеката, Бытовые дела, Развитие проффесиональное, Отдых (порядок - просто перечисление, не содержит приоретиацию)"]}),_e=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:"Ежедневная забота о теле – основа всего."}),e.jsx(c.Paragraph,{children:"Утренняя зарядка, прогулка, питьевой режим, здоровый сон и питание дают энергию, укрепляют иммунитет и повышают стрессоустойчивость, позволяя эффективно справляться с любыми задачами."}),e.jsx(c.Paragraph,{children:"Например для меня, это стакан воды в день, утренняя зарядка с обливаниями, три раза в неделю упражнения\\бег, упражнения для глаз."})]}),Ue=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:"Социальные коммуникации."}),e.jsx(c.Title,{level:3,children:"Общение – фундамент эмоционального благополучия."}),e.jsx(c.Paragraph,{children:"Короткий разговор с близким, обед с коллегой или вежливый диалог с соседом поддерживают связи, дарят чувство принадлежности, помогают решать вопросы и снимают напряжение, делая жизнь насыщеннее.."}),e.jsx(c.Paragraph,{children:"Например для меня, это провести время с Семьей или позвонить Отцу, Брату, навестить Маму на работе, позвонить с другом."})]}),De=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:" Духовно-нравственная воспитание"}),e.jsxs(c.Paragraph,{children:["Сюда я вынес все то с чем мы сталиваемся в поисках ответов на след вопросы:",e.jsx("br",{}),"Кто я? Есть ли Бог? Быть или не быть? Что для меня важно и во что я верю и т.д.",e.jsx("br",{}),"Слово это все то, что помогает Вам познать себя, мир вокруг Вас от бесконечно малого во внутрь, до бесконечно большого во вне"]}),e.jsx(c.Paragraph,{children:"Работа над этим необходимо, как мне кажется, чтобы обрести некий фундамент осознанности в поступках и убеждений"}),e.jsxs(c.Paragraph,{children:["Не буду углублять в какую-то философию или религизность - это Ваше личное дело, Ваш личный путь...",e.jsx("br",{}),"Как пример: лично для меня сюда вошли утренние и вечерние молитвы, работа по 12 шаговой программе, дыхательные упражнения"]})]}),Me=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:"Домашние дела."}),e.jsx(c.Title,{level:3,children:"Порядок вокруг создает порядок внутри."}),e.jsx(c.Paragraph,{children:"Быстрая уборка, мытье посуды, приготовление еды или раскладывание вещей по местам поддерживают комфортную среду, экономят время в будущем, снижают хаос и стресс, освобождая голову для важного."}),e.jsx(c.Paragraph,{children:"Например для меня, это все домашние дела которые могут возникнуть от поменять лампочки и наточить ножи до сделать навес над верандой, распечтать документы, оплатить домен, словом обычные бытовые дела которые должны быть сделаны."})]}),qe=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:"Личностное-Профессиональное развитие"}),e.jsx(c.Title,{level:3,children:"Постоянное движение вперед – залог роста"}),e.jsx(c.Paragraph,{children:"Чтение профессиональной статьи, изучение нового навыка, планирование карьеры или работа над личными качествами (например, тайм-менеджмент) повышают компетентность, уверенность, открывают новые возможности и предотвращают застой."}),e.jsx(c.Paragraph,{children:"Например для меня, это чтение статьи по профессиональной сфере, создание этого и других приложений, подготовка докладов"})]}),Be=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:"Интеллектуальные упражнения"}),e.jsx(c.Title,{level:3,children:"Тренировка для ума сохраняет его остроту"}),e.jsx(c.Paragraph,{children:"Разгадывание кроссворда, изучение иностранных слов, анализ прочитанного, решение логических задач или игра в шахматы стимулируют мозг, улучшают память, концентрацию и гибкость мышления, помогая находить нестандартные решения."}),e.jsx(c.Paragraph,{children:"Например для меня, это разгадывание судоку, филвордов, игры в го, решение задач на алгоритмы"})]}),ze=()=>e.jsxs(e.Fragment,{children:[e.jsx(c.Title,{level:2,children:"Время для себя"}),e.jsx(c.Title,{level:3,children:"Перезагрузка необходима для продуктивности."}),e.jsx(c.Paragraph,{children:". Сознательное безделье, любимое хобби, медитация, теплая ванна или просто тишина позволяют телу и психике восстановиться, предотвращают выгорание, восполняют ресурсы и дарят радость, делая остальное время более качественным."}),e.jsx(c.Paragraph,{children:"Например для меня, это просмотр мультиков, сериалов порой рисование - тут если честно мне трудно но в пути"})]}),V={soul:{id:L.soul,title:"Дух",icon:jt,info:De},health:{id:L.health,title:"Здоровье",icon:yt,info:_e},social:{id:L.social,title:"Социум",icon:kt,info:Ue},life:{id:L.life,title:"Быт",icon:me,info:Me},growth:{id:L.growth,title:"Развитие",icon:vt,info:qe},mind:{id:L.mind,title:"Интеллект",icon:wt,info:Be},rest:{id:L.rest,title:"Отдых",icon:bt,info:ze}},Ds=Object.keys(V).map(t=>V[t]),we=({title:t,total:s=0,complite:a=0,tasks:r,taskStatus:n,typeId:o,hasUndoneImportant:l})=>{const[u,x]=i.useState(!1),I=ae(),[T]=g.useForm(),{user:w}=B(),k=i.useRef(null),{mutate:A,isPending:$}=N({mutationFn:async h=>await D.createTask(h),onSuccess(h){I.setQueryData([M.tasks,w.id],O=>[...O,h])}}),j=n===C.active,d=({task:h})=>{A({task:h,taskStatus:n,typeId:o,authorId:w.id},{onError:O=>{U.error(O.name)},onSuccess:()=>{T.resetFields(),setTimeout(()=>{var O;(O=k.current)==null||O.focus()},0)}})};i.useEffect(()=>{var h;u&&((h=k.current)==null||h.focus())},[u]);const m=r.sort((h,O)=>+h.important-+O.important>0?-1:1);return e.jsxs(p,{vertical:!0,className:q({"task-fields-group":!0,"task-fields-group--active":j,"task-fields-group--plan":!j}),children:[e.jsxs(p,{justify:"space-between",className:"task-fields-group-title-wrapper",children:[e.jsxs(c.Text,{className:"task-fields-group-title",strong:!0,style:{color:j?"var(--ant-orange-7)":"var(--ant-green-7)"},children:[t,":"]}),e.jsx(ue,{count:a?`${a}/${s}`:s,className:q({"task-fields-group-badge":!0,"task-fields-group-badge--active":j})})]}),e.jsx(g,{onFinish:d,form:T,className:"task-fields-group-form",children:e.jsx(g.Item,{noStyle:!0,name:"task",children:e.jsx(b,{ref:k,onClick:()=>x(!0),onBlur:()=>x(!1),disabled:$||n==C.active&&l,className:q("task-input","task-input-create",j&&"task-input-create--active"),placeholder:u?"":"Создать задачу",prefix:u?e.jsx(It,{}):e.jsx(Tt,{})})})}),e.jsx("div",{className:"task-fields-group-content",children:m.map(h=>e.jsx(As,{task:h,isChangeStateBlock:n==C.new&&l},h.id))})]})},Ms=({active:t=!1,tasks:s=[],type:a,userId:r})=>{const[n,o]=i.useState(null),l=n==="completed",u=n==="info",{data:x=[],isFetching:I}=G({...D.getUserCompletedTasks(r,a),enabled:l});if(i.useEffect(()=>{!t&&l&&o(null)},[t,l]),!t||!a)return;const w=V[a].info,{activeTasks:k=[],newTasks:A=[]}=s.reduce((d,m)=>(m.status_id==="new"&&d.newTasks.push(m),m.status_id==="active"&&d.activeTasks.push(m),d),{newTasks:[],activeTasks:[]}),$=k.filter(({done:d})=>d).length,j=k.some(({important:d,done:m})=>d&&!m);return e.jsxs(p,{className:"task-type-panel",vertical:!0,align:"start",gap:8,children:[e.jsxs(p,{className:"task-type-panel__content",vertical:!0,flex:1,children:[e.jsx(we,{title:"В работе",complite:$,total:k.length,hasUndoneImportant:j,taskStatus:C.active,tasks:k,typeId:a}),e.jsx(Ct,{className:"task-type-panel__divider",orientation:"left",orientationMargin:"1rem",children:e.jsxs("div",{className:"task-type-panel__float-buttons",children:[e.jsx(f,{icon:l?e.jsx(St,{}):e.jsx(Pt,{}),title:"Показать выполненные",type:"link",onClick:d=>{d.stopPropagation(),o(l?null:"completed")}}),e.jsx(f,{onClick:()=>{o(u?null:"info")},icon:u?e.jsx(Rt,{}):e.jsx(Ft,{}),type:"link"})]})}),e.jsx(we,{title:"Запланированы",hasUndoneImportant:j,total:A.length,taskStatus:C.new,tasks:A,typeId:a})]}),e.jsxs(Fe,{className:"tasks-additional-info-drawer",title:e.jsxs(e.Fragment,{children:[e.jsxs(c.Text,{type:"secondary",children:[l&&" Завершенные задачи :",u&&"Подсказка о характере задач :"]}),e.jsx(ue,{count:l&&x.length||"0_-",color:"cyan"})]}),onClose:d=>{d.stopPropagation(),o(null)},mask:!1,open:l||u,styles:{mask:{background:"none"},header:{padding:"0.5rem 1rem"},body:{padding:"0.5rem 1rem",height:"100%",background:"var(--gray-2)"}},children:[l&&e.jsx(p,{vertical:!0,gap:16,className:"tasks-completed-wrapper",children:e.jsx(pe,{spinning:I,size:"large",children:x.map((d,m)=>i.createElement(_s,{...d,key:m}))})}),u&&e.jsx(w,{})]})]})},qs=({stats:t,onClick:s,active:a=!1,id:r,title:n})=>{const o=V[r].icon||null;return e.jsxs(p,{className:q({"task-type-container":!0,"task-type-container--active":a}),onClick:l=>{l.stopPropagation(),s==null||s(r)},children:[o&&e.jsx(o,{style:{fontSize:32}}),e.jsxs(p,{vertical:!0,children:[e.jsx(c.Title,{level:3,children:n}),e.jsxs(p,{style:{fontSize:"14px",lineHeight:1.2},gap:16,className:"task-type__stats",children:[e.jsxs(c.Text,{strong:!0,children:["Сделано: ",t.done]}),e.jsxs(c.Text,{children:["В работе: ",t.inWork]})]})]})]})},Bs=()=>{const[t,s]=i.useState(null),a=Q(),{taskGroups:r,userTasksIsLoading:n,userId:o}=Ls(),l=u=>{s(t===u?null:u)};return e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"task-page-content",onClick:()=>{s(null)},children:e.jsx(pe,{spinning:n,children:e.jsx(p,{className:q("tasks-types-container",{"tasks-types-container--active":t}),children:r&&Object.keys(r).map(u=>e.jsx(qs,{active:t===u,title:r[u].label,id:u,onClick:l,stats:r[u].stats},u))})})}),e.jsx(Fe,{className:q("tasks-page-sider ",!t&&"tasks-page-sider--collapsed"),open:!!t,closable:!1,mask:!1,push:!1,getContainer:()=>document.querySelector(".task-page-content")||document.body,classNames:{wrapper:"tasks-page-sider-wrapper"},children:e.jsx(Ms,{tasks:t?r[t].data:[],active:!!t,type:t,closeForm:()=>a(F.BASE),userId:o},t)})]})},zs=t=>i.createElement("svg",{width:"143.49536mm",height:"122.80552mm",viewBox:"0 0 143.49536 122.80552",id:"svg5",xmlnsXlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/svg","xmlns:svg":"http://www.w3.org/2000/svg",...t},i.createElement("defs",{id:"defs2"}),i.createElement("g",{id:"layer1",transform:"translate(-45.930734,-34.912509)"},i.createElement("g",{id:"g2544",transform:"translate(-0.87950327)"},i.createElement("text",{xmlSpace:"preserve",style:{fontSize:"61.9697px",lineHeight:.4,fontFamily:"Bahnschrift",InkscapeFontSpecification:"Bahnschrift",fill:"#4c47f7",stroke:"#000000",strokeWidth:0,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"none",strokeDashoffset:1.05827,paintOrder:"fill markers stroke"},x:62.63818,y:118.4164,id:"text236"},i.createElement("tspan",{id:"tspan234",style:{fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontFamily:"'Lucida Console'",InkscapeFontSpecification:"'Lucida Console'",fill:"#000000",fillOpacity:1,strokeWidth:0,strokeDasharray:"none"},x:62.63818,y:118.4164},i.createElement("tspan",{style:{fill:"#8c8c8c",fillOpacity:1},id:"tspan3600"},"4"),"0")),i.createElement("text",{xmlSpace:"preserve",style:{fontSize:"61.9697px",lineHeight:.4,fontFamily:"Bahnschrift",InkscapeFontSpecification:"Bahnschrift",fill:"#4c47f7",stroke:"#000000",strokeWidth:0,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"none",strokeDashoffset:1.05827,paintOrder:"fill markers stroke"},x:-174.00565,y:118.4164,id:"text236-6",transform:"scale(-1,1)"},i.createElement("tspan",{id:"tspan234-5",style:{fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontFamily:"'Lucida Console'",InkscapeFontSpecification:"'Lucida Console'",fill:"#8c8c8c",fillOpacity:1,strokeWidth:0,strokeDasharray:"none"},x:-174.00565,y:118.4164},"4"))),i.createElement("text",{xmlSpace:"preserve",style:{fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fontStretch:"normal",fontSize:"9.87778px",lineHeight:.4,fontFamily:"'Lucida Console'",InkscapeFontSpecification:"'Lucida Console'",letterSpacing:0,wordSpacing:0,fill:"#000000",fillOpacity:1,stroke:"none",strokeWidth:.4,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"none",strokeDashoffset:1.05827,paintOrder:"fill markers stroke"},id:"text2152",transform:"rotate(-1.438715,-401.31432,179.37148)"},i.createElement("textPath",{xlinkHref:"#path2399",id:"textPath2502",style:{fontSize:"9.87778px"}},i.createElement("tspan",{id:"tspan2150",style:{fontSize:"9.87778px",strokeWidth:.4},dx:0,dy:0,rotate:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0"},"страница не найдена"))),i.createElement("path",{style:{fill:"none",fillOpacity:1,stroke:"#000000",strokeWidth:0,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"none",strokeDashoffset:1.05827,strokeOpacity:1,paintOrder:"fill markers stroke"},d:"m 65.040689,139.41204 c 38.596841,20.35488 72.893801,19.78702 104.803441,0 v 0.17068",id:"path2399"}),i.createElement("ellipse",{style:{fill:"none",fillOpacity:1,stroke:"#8c8c8c",strokeWidth:.924746,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"none",strokeDashoffset:1.05827,strokeOpacity:1,paintOrder:"fill markers stroke"},id:"path2548",cx:117.67841,cy:96.315277,rx:71.285309,ry:60.940395}))),Ws=()=>{const t=Q();return e.jsxs(p,{align:"center",justify:"center",style:{position:"relative",width:"100%",height:"100%"},children:[e.jsx(f,{type:"text",icon:e.jsx(me,{}),style:{position:"absolute",left:"0.2rem",top:"0.2rem"},title:"На главную",onClick:()=>{t(F.BASE)}}),e.jsx(zs,{})]})},Ys=()=>e.jsx(p,{className:"auth-layout-container",vertical:!0,gap:"middle",align:"center",justify:"center",children:e.jsxs(p,{className:"auth-layout-content",vertical:!0,align:"center",justify:"center",children:[e.jsx(c.Title,{level:1,children:"7S"}),e.jsx(be,{})]})}),Gs=t=>{const{x:s,y:a,payload:r}=t,n=V[r.value].icon;return e.jsx("g",{transform:`translate(${s},${a})`,children:e.jsx("foreignObject",{x:-30,y:-12,width:24,height:24,children:e.jsx("div",{style:{width:"24px",height:"24px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(n,{})})})})},Qs=({active:t,payload:s})=>{var r;const a=(r=s==null?void 0:s[0])==null?void 0:r.payload;return t&&a?e.jsx("div",{className:"custom-tooltip",style:{backgroundColor:"white",padding:"10px",border:"1px solid #ccc",borderRadius:"4px"},children:e.jsx(c.Paragraph,{children:`${V[a.type].title}: ${s[0].value}`})}):null},Hs=({data:t})=>e.jsx($t,{width:"100%",height:"100%",children:e.jsxs(Ot,{data:t,layout:"vertical",children:[e.jsx(Lt,{strokeDasharray:"30 25"}),e.jsx(Nt,{type:"number",hide:!0}),e.jsx(At,{type:"category",dataKey:"type",tick:Gs}),e.jsx(_t,{content:e.jsx(Qs,{})}),e.jsx(Ut,{dataKey:"value",fill:"#8884d8",radius:[0,4,4,0],children:e.jsx(Dt,{dataKey:"value",position:"insideRight",fill:"var(--gray-4)",fontSize:18,fontWeight:"bold"})})]})}),Vs=t=>{const{data:s=[],isLoading:a}=G({...D.getTaskTypes(),refetchOnWindowFocus:!1,refetchOnMount:!1}),{data:r=[],isLoading:n}=G({...D.getUserCompletedTasks(t),refetchIntervalInBackground:!0,refetchInterval:5*Ne,refetchOnWindowFocus:!1,enabled:!!t}),o=i.useMemo(()=>{const u={};return s.length&&s.forEach(x=>{u[x.id]||(u[x.id]=0)}),r.forEach(x=>{++u[x.type_id]}),u},[r,s]),l=Math.max(...Object.values(o))||7;return{taskTypes:s,userTasks:r,taskTypesIsLoading:a,userTasksIsLoading:n,taskGroupStats:o,maxPower:l}},Js=()=>{const{user:t}=B(),{taskGroupStats:s,maxPower:a}=Vs(t.id),r=Object.keys(s).length?Object.entries(s).map(([n,o])=>({type:n,value:o,fullMark:a})):[];return e.jsx(p,{vertical:!0,flex:1,style:{height:"100%",width:"100%",padding:"0.2rem",maxHeight:"var(--content-height)"},children:e.jsx(Hs,{data:r})})},Xs=()=>{const t=Q(),s=N({mutationFn:a=>ne.updatePassword(a),onSuccess:()=>{U.info("Пароль успешно обновлен"),t(F.SIGN_IN)},onError:a=>{U.error(a.message||"Произошла ошибка при обновлении пароля. Попробуйте позже или обратитесь к администратору")}});return e.jsxs(g,{name:"sign-in",layout:"vertical",style:{width:"100%"},onFinish:({password:a})=>s.mutate(a),children:[e.jsx(g.Item,{name:"password",label:"Новый пароль",rules:[{required:!0,message:E.REQUIRED}],children:e.jsx(b.Password,{size:"large",type:"password"})}),e.jsx(g.Item,{name:"passwordRepeat",dependencies:["password"],label:"Повторите пароль",rules:[{required:!0,message:E.REQUIRED},({getFieldValue:a})=>({validator(r,n){return!n||a("password")===n?Promise.resolve():Promise.reject(new Error(E.PASSWORD_DUPLICATE))}})],children:e.jsx(b.Password,{size:"large",type:"password"})}),e.jsx(g.Item,{style:{textAlign:"center"},children:e.jsx(f,{type:"primary",htmlType:"submit",block:!0,size:"large",loading:s.isPending,children:"Обновить пароль"})})]})},Ks=()=>{const[t,s]=i.useState(null),a=n=>()=>{s(o=>o&&o.id===n.id?null:n)},r=t!=null&&t.info?Zs[t.id]:Us;return e.jsx(p,{vertical:!0,className:"info-page-wrapper",children:e.jsxs(p,{className:"info-page-content-container",children:[e.jsx(p,{gap:8,className:"info-page-buttons",vertical:!0,children:Ds.map(n=>{const o=n.icon;return o?e.jsx(f,{type:"text",className:(t==null?void 0:t.id)===n.id?"info-page-button-active":"",icon:e.jsx(o,{}),title:n.title,onClick:a(n)},n.id):null})}),e.jsx(p,{className:"info-page-content-wrapper",justify:"center",children:e.jsxs(p,{className:"info-page-content",vertical:!0,gap:8,children:[e.jsx(c.Title,{level:1,children:(t==null?void 0:t.title)||"Зачем приложение нужно"}),r&&e.jsx(r,{})]})})]})})},Zs={[L.soul]:De,[L.growth]:qe,[L.health]:_e,[L.life]:Me,[L.mind]:Be,[L.rest]:ze,[L.social]:Ue},ea=[{Component:Ys,children:[{index:!0,Component:ve},{path:F.SIGN_IN,Component:ve},{path:F.SIGN_UP,Component:is},{path:F.RESET_PASSWORD,Component:ls},{path:F.UPDATE_PASSWORD,Component:Xs},{path:"*",loader:()=>Ze("/")}]}],ta=[{Component:Is,children:[{index:!0,Component:Bs},{path:F.STATISTIC,Component:Js,handle:{title:"Статистика"}},{path:F.INFO,Component:Ks,handle:{title:"О Приложении"}},{path:"*",Component:Ws}]}],sa=()=>{const{isAuthCheking:t,user:s,isUserLoading:a}=B();if(i.useEffect(()=>{function n(){const o=window.visualViewport?window.visualViewport.height:window.innerHeight;document.documentElement.style.setProperty("--app-height",`${o}px`)}return window.addEventListener("resize",n),window.addEventListener("orientationchange",n),n(),()=>{window.removeEventListener("resize",n),window.removeEventListener("orientationchange",n)}},[]),t||a)return e.jsx(pe,{fullscreen:!0});const r=et(s!=null&&s.id?ta:ea);return e.jsx(tt,{router:r})};let K=document.getElementById("root");K||(K=document.createElement("div"),K.id="root",document.body.appendChild(K));Ee(K).render(e.jsx(i.StrictMode,{children:e.jsxs(He,{client:Jt,children:[e.jsx(Et,{theme:Xt,locale:Bt,children:e.jsx(Vt,{children:e.jsx(sa,{})})}),e.jsx(Ve,{initialIsOpen:!1})]})}));
